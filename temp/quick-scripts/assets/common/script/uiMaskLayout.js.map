{"version":3,"sources":["uiMaskLayout.js"],"names":["uiPanel","require","cc","Class","extends","start","clientEvent","on","eventType","openUI","uiOperateCallBack","closeUI","isUseMask","node","active","lastMaskIndex","i","uiFunc","uiList","length","ui","panel","getComponent","j","targetUI","setSiblingIndex","Number","MAX_SAFE_INTEGER","console","log","refresh","onDestroy","off"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASJ,OADJ;AAEL;AACAK,SAHK,mBAGG;AACJC,oBAAYC,EAAZ,CAAeD,YAAYE,SAAZ,CAAsBC,MAArC,EAA6C,KAAKC,iBAAlD,EAAqE,IAArE;AACAJ,oBAAYC,EAAZ,CAAeD,YAAYE,SAAZ,CAAsBG,OAArC,EAA8C,KAAKD,iBAAnD,EAAsE,IAAtE;AACA,aAAKE,SAAL,GAAiB,KAAjB;AACA,aAAKC,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACH,KARI;;;AAULJ,uBAAmB,6BAAW;AAC1B;AACA,YAAIK,gBAAgB,CAAC,CAArB;AACA,aAAK,IAAIC,IAAIC,OAAOC,MAAP,CAAcC,MAAd,GAAuB,CAApC,EAAuCH,KAAK,CAA5C,EAA+CA,GAA/C,EAAoD;AAChD,gBAAII,KAAKH,OAAOC,MAAP,CAAcF,CAAd,CAAT;AACA,gBAAIK,QAAQD,GAAGE,YAAH,CAAgB,SAAhB,CAAZ;AACA,gBAAID,SAASA,MAAMT,SAAnB,EAA8B;AAC1BG,gCAAgBC,CAAhB;AACA;AACH;AACJ;AACD,YAAID,iBAAiB,CAArB,EAAwB;AACpB,iBAAKF,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACA,iBAAK,IAAIS,IAAIR,aAAb,EAA4BQ,IAAIN,OAAOC,MAAP,CAAcC,MAA9C,EAAsDI,GAAtD,EAA2D;AACvD,oBAAIC,WAAWP,OAAOC,MAAP,CAAcK,CAAd,CAAf;AACA,oBAAIC,QAAJ,EAAc;AACV,yBAAKX,IAAL,CAAUY,eAAV,CAA0BC,OAAOC,gBAAjC;AACAH,6BAASC,eAAT,CAAyBC,OAAOC,gBAAhC;AACH,iBAHD,MAGO;AACHC,4BAAQC,GAAR,CAAY,0BAAZ;AACH;AACJ;AACJ,SAXD,MAWO;AACH,iBAAKhB,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA;AACH;AACJ,KApCI;;AAsCLgB,aAAS,mBAAW;AAChB;AACA,YAAIf,gBAAgB,CAAC,CAArB;AACA,aAAK,IAAIC,IAAIC,OAAOC,MAAP,CAAcC,MAAd,GAAuB,CAApC,EAAuCH,KAAK,CAA5C,EAA+CA,GAA/C,EAAoD;AAChD,gBAAII,KAAKH,OAAOC,MAAP,CAAcF,CAAd,CAAT;AACA,gBAAIK,QAAQD,GAAGE,YAAH,CAAgB,SAAhB,CAAZ;AACA,gBAAID,MAAMT,SAAV,EAAqB;AACjBG,gCAAgBC,CAAhB;AACA;AACH;AACJ;AACD,YAAID,iBAAiB,CAArB,EAAwB;AACpB,iBAAKF,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACA,iBAAK,IAAIS,IAAIR,aAAb,EAA4BQ,IAAIN,OAAOC,MAAP,CAAcC,MAA9C,EAAsDI,GAAtD,EAA2D;AACvD,oBAAIC,WAAWP,OAAOC,MAAP,CAAcK,CAAd,CAAf;AACA,oBAAIC,QAAJ,EAAc;AACV,yBAAKX,IAAL,CAAUY,eAAV,CAA0BC,OAAOC,gBAAjC;AACAH,6BAASC,eAAT,CAAyBC,OAAOC,gBAAhC;AACH,iBAHD,MAGO;AACHC,4BAAQC,GAAR,CAAY,0BAAZ;AACH;AACJ;AACJ,SAXD,MAWO;AACH,iBAAKhB,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA;AACH;AACJ,KAhEI;;AAkELiB,eAAW,qBAAW;AAClBzB,oBAAY0B,GAAZ,CAAgB1B,YAAYE,SAAZ,CAAsBC,MAAtC,EAA8C,KAAKC,iBAAnD,EAAsE,IAAtE;AACAJ,oBAAY0B,GAAZ,CAAgB1B,YAAYE,SAAZ,CAAsBG,OAAtC,EAA+C,KAAKD,iBAApD,EAAuE,IAAvE;AACH;AArEI,CAAT","file":"uiMaskLayout.js","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\ncc.Class({\n    extends: uiPanel,\n    // LIFE-CYCLE CALLBACKS:\n    start() {\n        clientEvent.on(clientEvent.eventType.openUI, this.uiOperateCallBack, this);\n        clientEvent.on(clientEvent.eventType.closeUI, this.uiOperateCallBack, this);\n        this.isUseMask = false;\n        this.node.active = false;\n    },\n\n    uiOperateCallBack: function() {\n        // 最后一个需要使用mask的panel\n        var lastMaskIndex = -1;\n        for (var i = uiFunc.uiList.length - 1; i >= 0; i--) {\n            var ui = uiFunc.uiList[i];\n            var panel = ui.getComponent(\"uiPanel\");\n            if (panel && panel.isUseMask) {\n                lastMaskIndex = i;\n                break;\n            }\n        }\n        if (lastMaskIndex >= 0) {\n            this.node.active = true;\n            for (var j = lastMaskIndex; j < uiFunc.uiList.length; j++) {\n                var targetUI = uiFunc.uiList[j];\n                if (targetUI) {\n                    this.node.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                    targetUI.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                } else {\n                    console.log(\"current show ui is null!\");\n                }\n            }\n        } else {\n            this.node.active = false;\n            return;\n        }\n    },\n\n    refresh: function() {\n        // 最后一个需要使用mask的panel\n        var lastMaskIndex = -1;\n        for (var i = uiFunc.uiList.length - 1; i >= 0; i--) {\n            var ui = uiFunc.uiList[i];\n            var panel = ui.getComponent(\"uiPanel\");\n            if (panel.isUseMask) {\n                lastMaskIndex = i;\n                break;\n            }\n        }\n        if (lastMaskIndex >= 0) {\n            this.node.active = true;\n            for (var j = lastMaskIndex; j < uiFunc.uiList.length; j++) {\n                var targetUI = uiFunc.uiList[j];\n                if (targetUI) {\n                    this.node.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                    targetUI.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                } else {\n                    console.log(\"current show ui is null!\");\n                }\n            }\n        } else {\n            this.node.active = false;\n            return;\n        }\n    },\n\n    onDestroy: function() {\n        clientEvent.off(clientEvent.eventType.openUI, this.uiOperateCallBack, this);\n        clientEvent.off(clientEvent.eventType.closeUI, this.uiOperateCallBack, this);\n    }\n});\n"]}